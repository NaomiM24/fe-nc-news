{"ast":null,"code":"import _classCallCheck from\"/home/anatd/Naomi/northcoders/week9/fe-nc-news/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/anatd/Naomi/northcoders/week9/fe-nc-news/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/anatd/Naomi/northcoders/week9/fe-nc-news/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/anatd/Naomi/northcoders/week9/fe-nc-news/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/anatd/Naomi/northcoders/week9/fe-nc-news/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import*as api from\"../api\";var ArticleVotesChange=/*#__PURE__*/function(_Component){_inherits(ArticleVotesChange,_Component);function ArticleVotesChange(){var _getPrototypeOf2;var _this;_classCallCheck(this,ArticleVotesChange);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ArticleVotesChange)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={vote:0,error:{status:null,msg:\"\"}};_this.handleClick=function(event){_this.setState({vote:event.target.value});};return _this;}_createClass(ArticleVotesChange,[{key:\"render\",value:function render(){var _this$state$error=this.state.error,status=_this$state$error.status,msg=_this$state$error.msg;return React.createElement(\"div\",null,\"votes: \",this.props.article_vote+ +this.state.vote,React.createElement(\"br\",null),React.createElement(\"button\",{className:\"like\",value:1,onClick:this.handleClick,disabled:this.state.vote===1?true:false},\"Like\"),React.createElement(\"button\",{className:\"dislike\",value:-1,onClick:this.handleClick,disabled:this.state.vote===-1?true:false},\"Dislike\"),React.createElement(\"button\",{className:\"cancel\",value:0,onClick:this.handleClick,disabled:this.state.vote===0?true:false},\"Cancel Vote\"),status!==null&&React.createElement(\"p\",null,\"Error \",status,\"! \",msg));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this2=this;var article_id=this.props.article_id;if(+this.state.vote===0&&+prevState.vote!==0){var vote=-+prevState.vote;api.updateArticleVotes(article_id,vote).catch(function(error){return _this2.setState({vote:0,error:{status:500,msg:\"cancel vote did not work at this time, please try again later\"}});});}else if(prevState.vote!==this.state.vote){var _vote=this.state.vote;api.updateArticleVotes(article_id,_vote).catch(function(error){return _this2.setState({vote:0,error:{status:500,msg:\"voting did not work, please try again later\"}});});}}}]);return ArticleVotesChange;}(Component);export default ArticleVotesChange;","map":{"version":3,"sources":["/home/anatd/Naomi/northcoders/week9/fe-nc-news/src/components.js/ArticleVotesChange.jsx"],"names":["React","Component","api","ArticleVotesChange","state","vote","error","status","msg","handleClick","event","setState","target","value","props","article_vote","prevProps","prevState","article_id","updateArticleVotes","catch"],"mappings":"mpBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAO,GAAKC,CAAAA,GAAZ,KAAqB,QAArB,C,GAGMC,CAAAA,kB,+aACJC,K,CAAQ,CACNC,IAAI,CAAE,CADA,CAENC,KAAK,CAAE,CACLC,MAAM,CAAE,IADH,CAELC,GAAG,CAAE,EAFA,CAFD,C,OAiDRC,W,CAAc,SAAAC,KAAK,CAAI,CACrB,MAAKC,QAAL,CAAc,CAAEN,IAAI,CAAEK,KAAK,CAACE,MAAN,CAAaC,KAArB,CAAd,EACD,C,qFA5CQ,uBACiB,KAAKT,KAAL,CAAWE,KAD5B,CACCC,MADD,mBACCA,MADD,CACSC,GADT,mBACSA,GADT,CAGP,MACE,0CACU,KAAKM,KAAL,CAAWC,YAAX,CAA0B,EAAC,KAAKX,KAAL,CAAWC,IADhD,CAEE,8BAFF,CAGE,8BACE,SAAS,CAAC,MADZ,CAEE,KAAK,CAAE,CAFT,CAGE,OAAO,CAAE,KAAKI,WAHhB,CAIE,QAAQ,CAAE,KAAKL,KAAL,CAAWC,IAAX,GAAoB,CAApB,CAAwB,IAAxB,CAA+B,KAJ3C,SAHF,CAYE,8BACE,SAAS,CAAC,SADZ,CAEE,KAAK,CAAE,CAAC,CAFV,CAGE,OAAO,CAAE,KAAKI,WAHhB,CAIE,QAAQ,CAAE,KAAKL,KAAL,CAAWC,IAAX,GAAoB,CAAC,CAArB,CAAyB,IAAzB,CAAgC,KAJ5C,YAZF,CAqBE,8BACE,SAAS,CAAC,QADZ,CAEE,KAAK,CAAE,CAFT,CAGE,OAAO,CAAE,KAAKI,WAHhB,CAIE,QAAQ,CAAE,KAAKL,KAAL,CAAWC,IAAX,GAAoB,CAApB,CAAwB,IAAxB,CAA+B,KAJ3C,gBArBF,CA6BGE,MAAM,GAAK,IAAX,EACC,sCACSA,MADT,MACmBC,GADnB,CA9BJ,CADF,CAqCD,C,8DAMkBQ,S,CAAWC,S,CAAW,oBAC/BC,CAAAA,UAD+B,CAChB,KAAKJ,KADW,CAC/BI,UAD+B,CAEvC,GAAI,CAAC,KAAKd,KAAL,CAAWC,IAAZ,GAAqB,CAArB,EAA0B,CAACY,SAAS,CAACZ,IAAX,GAAoB,CAAlD,CAAoD,CAClD,GAAMA,CAAAA,IAAI,CAAG,CAAE,CAACY,SAAS,CAACZ,IAA1B,CACAH,GAAG,CAACiB,kBAAJ,CAAuBD,UAAvB,CAAmCb,IAAnC,EAAyCe,KAAzC,CAA+C,SAAAd,KAAK,CAAI,CACtD,MAAO,CAAA,MAAI,CAACK,QAAL,CAAc,CACnBN,IAAI,CAAE,CADa,CAEnBC,KAAK,CAAE,CACLC,MAAM,CAAE,GADH,CAELC,GAAG,CAAE,+DAFA,CAFY,CAAd,CAAP,CAOD,CARD,EASD,CAXD,IAaK,IAAIS,SAAS,CAACZ,IAAV,GAAmB,KAAKD,KAAL,CAAWC,IAAlC,CAAwC,IACnCA,CAAAA,KADmC,CAC1B,KAAKD,KADqB,CACnCC,IADmC,CAE3CH,GAAG,CAACiB,kBAAJ,CAAuBD,UAAvB,CAAmCb,KAAnC,EAAyCe,KAAzC,CAA+C,SAAAd,KAAK,CAAI,CACtD,MAAO,CAAA,MAAI,CAACK,QAAL,CAAc,CACnBN,IAAI,CAAE,CADa,CAEnBC,KAAK,CAAE,CACLC,MAAM,CAAE,GADH,CAELC,GAAG,CAAE,6CAFA,CAFY,CAAd,CAAP,CAOD,CARD,EASD,CACF,C,gCAjF8BP,S,EAoFjC,cAAeE,CAAAA,kBAAf","sourcesContent":["import React, { Component } from \"react\";\nimport * as api from \"../api\";\n\n\nclass ArticleVotesChange extends Component {\n  state = {\n    vote: 0,\n    error: {\n      status: null,\n      msg: \"\"\n    }\n  };\n  render() {\n    const { status, msg } = this.state.error;\n\n    return (\n      <div>\n        votes: {this.props.article_vote + +this.state.vote}\n        <br />\n        <button\n          className=\"like\"\n          value={1}\n          onClick={this.handleClick}\n          disabled={this.state.vote === 1 ? true : false}\n        >\n          Like\n          \n        </button>\n        <button\n          className=\"dislike\"\n          value={-1}\n          onClick={this.handleClick}\n          disabled={this.state.vote === -1 ? true : false}\n        >\n          Dislike\n        </button>\n        \n        <button\n          className=\"cancel\"\n          value={0}\n          onClick={this.handleClick}\n          disabled={this.state.vote === 0 ? true : false}\n        >\n          Cancel Vote\n        </button>\n        {status !== null && (\n          <p>\n            Error {status}! {msg}\n          </p>\n        )}\n      </div>\n    );\n  }\n\n  handleClick = event => {\n    this.setState({ vote: event.target.value });\n  };\n\n  componentDidUpdate(prevProps, prevState) {\n    const { article_id } = this.props;\n    if (+this.state.vote === 0 && +prevState.vote !== 0){\n      const vote = -(+prevState.vote)\n      api.updateArticleVotes(article_id, vote).catch(error => {\n        return this.setState({\n          vote: 0,\n          error: {\n            status: 500,\n            msg: \"cancel vote did not work at this time, please try again later\"\n          }\n        });\n      });\n    }\n  \n    else if (prevState.vote !== this.state.vote) {\n      const { vote } = this.state;\n      api.updateArticleVotes(article_id, vote).catch(error => {\n        return this.setState({\n          vote: 0,\n          error: {\n            status: 500,\n            msg: \"voting did not work, please try again later\"\n          }\n        });\n      });\n    }\n  }\n}\n\nexport default ArticleVotesChange;\n"]},"metadata":{},"sourceType":"module"}